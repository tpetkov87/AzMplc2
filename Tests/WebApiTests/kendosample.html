<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Kendo Sample</title>
    <!-- JS lib's -->
    <script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
    <script src="http://cdn.kendostatic.com/2015.2.624/js/kendo.all.min.js"></script>

    <script src="sitefinity-sdk.js"></script>
    <link rel="stylesheet" href="http://cdn.kendostatic.com/2015.2.624/styles/kendo.common.min.css">
    <link rel="stylesheet" href="http://cdn.kendostatic.com/2015.2.624/styles/kendo.default.min.css">
</head>

<body>
    <div id="gridView"></div>
    <div id="details"></div>
    <input type="button" value="logout" onclick="logout()" />
    <script>
            var wnd, detailsTemplate;
            var options = {
                serviceUrl: window.location.origin + "/api/default/"
            }

            // Sitefinity object
            var sf = new Sitefinity(options);

            sf.authentication.login("admin", "admin@2", function (data) {
                var sitefinityDataSource = new kendo.data.DataSource({
                    type: 'sitefinity',
                    transport: {
                        urlName: 'newsitems',
                        providerName: 'OpenAccessDataProvider',
                        dataProvider: sf
                    },
                    schema: {
                        model: {
                            id: "Id",
                            fields: {
                                Id: { type: "string" },
                                Title: { type: "string" },
                                Content: { type: "string" },
                                Summary: { type: 'string' },
                                UrlName: { type: 'string' }
                            }
                        }
                    },
                    serverPaging: false,
                    serverSorting: true,
                    serverFiltering: true,
                    pageSize: 10,
                    page: 1,
                    sort: { field: 'Id', dir: 'desc' }
                });

                $("#gridView").kendoGrid({
                    pageable: true,
                    sortable: true,
                    filterable: true,
                    navigatable: true,
                    dataSource: sitefinityDataSource,
                    toolbar: ["create", "save", "cancel"],
                    columns: ["Id", "Title", "Content", "Summary", 'UrlName', { command: ["edit", "destroy", { text: "View Details", click: showDetails }], title: "&nbsp;", width: "300px" }],
                    editable: "inline"
                });

                wnd = $("#details")
                        .kendoWindow({
                            title: "News Details",
                            modal: true,
                            visible: false,
                            resizable: false,
                            width: 300
                        }).data("kendoWindow");
                detailsTemplate = kendo.template($("#template").html());
            });

            $(document).ready(function () {


                // sf.authentication.logout(function (data) { });
            });

            function showDetails(e) {
                e.preventDefault();

                var dataItem = this.dataItem($(e.currentTarget).closest("tr"));
                wnd.content(detailsTemplate(dataItem));
                wnd.center().open();
            }

            function logout() {
                sf.authentication.logout();
            }
    </script>
    <script type="text/x-kendo-template" id="template">
        <div id="details-container">
            <h2>#= Title #</h2>
            <em>#= Content #</em>
            <dl>
                <dt>Summary: #= Summary #</dt>
                <br />
                <dt>Id: #= Id #</dt>
            </dl>
        </div>
    </script>
    <style type="text/css">
        #details-container {
            padding: 10px;
        }

            #details-container h2 {
                margin: 0;
            }

            #details-container em {
                color: #8c8c8c;
            }

            #details-container dt {
                margin: 0;
                display: inline;
            }
    </style>

</body>
</html>
